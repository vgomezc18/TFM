---
title: "Contraste de métodos de imputación estadística en la documentación de víctimas del
conflicto armado colombiano"
author: "Valentina Gómez^[[valegome@ucm.es](valegome@ucm.es)]"
date: '`r format(Sys.time(), "%d %B %Y")`'
output: pdf_document
site: "bookdown::bookdown_site"
lang: es-CO
fig_width: 4
fig_height: 2.5
fontsize: 12pt
urlcolor: blue
editor_options: 
  markdown: 
    wrap: sentence
---
# Comparación modelos

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


require(pacman)
p_load(here, readr, tidyverse, dplyr, validate, data.table, missForest, 
			 VIM, lattice, simputation, mice, skimr, compareDF)


```

# Importación de datos:

```{r}

imputacion_dir <- here::here("08.modelos_imputacion/output")
documentado_dir <- here::here("01.tablas_documentadas/output")

output_dir <- here::here("09.comparacion_modelos/output")

imputacion_donante_edad_jep <- readRDS(paste0(imputacion_dir,"/imputacion_donante_edad_jep.rds")) 

# Función para cargar réplicas
cargar_replicas <- function(nombre_directorio, nombre_archivo, replicas) {
  verdata::read_replicates(here::here(nombre_directorio), nombre_archivo, replicas)
}

# Función para resumir tablas documentadas
resumir_tabla_documentada <- function(nombre_archivo, replicas, strata_vars, conflict_filter = TRUE, edad_minors_filter = FALSE, include_props = TRUE, forced_dis_filter = FALSE) {
	
  verdata::summary_observed(nombre_archivo,
                            replicas, 
                            strata_vars = strata_vars,
                            conflict_filter = conflict_filter,
                            edad_minors_filter = edad_minors_filter,
                            include_props = include_props,
                            forced_dis_filter = forced_dis_filter)
}

# Definir parámetros comunes
strata_vars_comunes <- c("edad_jep", "yy_hecho")
replicas <- c(1:10)

# Cargar réplicas
replicas_desaparicion <- cargar_replicas("01.tablas_documentadas/input/verdata-parquet/desaparicion", "desaparicion", replicas)

replicas_homicidio <- cargar_replicas("01.tablas_documentadas/input/verdata-parquet/homicidio", "homicidio", replicas)

replicas_secuestro <- cargar_replicas("01.tablas_documentadas/input/verdata-parquet/secuestro", "secuestro", replicas)

replicas_reclutamiento <- cargar_replicas("01.tablas_documentadas/input/verdata-parquet/reclutamiento", "reclutamiento", replicas)

# Crear tablas documentadas
tabla_documentada_desaparicion <- resumir_tabla_documentada("desaparicion", replicas_desaparicion, strata_vars_comunes, forced_dis_filter = TRUE)

tabla_documentada_homicidio <- resumir_tabla_documentada("homicidio", replicas_homicidio, strata_vars_comunes)

tabla_documentada_secuestro <- resumir_tabla_documentada("secuestro", replicas_secuestro, strata_vars_comunes)

tabla_documentada_reclutamiento <- resumir_tabla_documentada("reclutamiento", replicas_reclutamiento, strata_vars_comunes)

```


Inserto los resultados por donante: 

```{r}
donante_edad_jep_desap <- rbind(imputacion_donante_edad_jep[["desaparicion_1998_2000"]], 
			imputacion_donante_edad_jep[["desaparicion_2001_2005"]],
			imputacion_donante_edad_jep[["desaparicion_2006_2010"]],
			imputacion_donante_edad_jep[["desaparicion_2011_2016"]])

donante_edad_jep_homi <- rbind(imputacion_donante_edad_jep[["homicidio_1998_2000"]], 
			imputacion_donante_edad_jep[["homicidio_2001_2003"]],
			imputacion_donante_edad_jep[["homicidio_2004_2005"]],
			imputacion_donante_edad_jep[["homicidio_2006_2010"]],
			imputacion_donante_edad_jep[["homicidio_2011_2016"]])

donante_edad_jep_secue <- rbind(imputacion_donante_edad_jep[["secuestro_1998_2000"]], 
			imputacion_donante_edad_jep[["secuestro_2001_2005"]],
			imputacion_donante_edad_jep[["secuestro_2006_2010"]],
			imputacion_donante_edad_jep[["secuestro_2011_2016"]])

donante_edad_jep_reclu <- rbind(imputacion_donante_edad_jep[["reclutamiento_1998_2000"]], 
			imputacion_donante_edad_jep[["reclutamiento_2001_2005"]],
			imputacion_donante_edad_jep[["reclutamiento_2006_2010"]],
			imputacion_donante_edad_jep[["reclutamiento_2011_2016"]])
```

Inserto los resultados de JEP-CEV-HRDAG:

```{r}

tabla_combinada_desaparicion <- verdata::combine_replicates("desaparicion",
                                                tabla_documentada_desaparicion,
                                                replicas_desaparicion, 
                                                strata_vars = c("edad_jep", "yy_hecho"),
                                                conflict_filter = TRUE,
                                                forced_dis_filter = TRUE,
                                                edad_minors_filter = FALSE,
                                                include_props = TRUE)

tabla_combinada_desaparicion <- tabla_combinada_desaparicion %>% 
  select(yy_hecho, edad_jep, observed, obs_prop_na, obs_prop, imp_lo, imp_mean, imp_hi,
         imp_lo_p, imp_mean_p, imp_hi_p ) %>%
	merge(donante_edad_jep_desap, by = c("edad_jep", "yy_hecho"))

tabla_combinada_homicidio <- verdata::combine_replicates("homicidio",
                                                tabla_documentada_homicidio,
                                                replicas_homicidio, 
                                                strata_vars = c("edad_jep", "yy_hecho"),
                                                conflict_filter = TRUE,
                                                edad_minors_filter = FALSE,
                                                include_props = TRUE)

tabla_combinada_homicidio <- tabla_combinada_homicidio %>% 
  select(yy_hecho, edad_jep, observed, obs_prop_na, obs_prop, imp_lo, imp_mean, imp_hi,
         imp_lo_p, imp_mean_p, imp_hi_p ) %>%
	merge(donante_edad_jep_homi, by = c("edad_jep", "yy_hecho"))

tabla_combinada_secuestro <- verdata::combine_replicates("secuestro",
                                                tabla_documentada_secuestro,
                                                replicas_secuestro, 
                                                strata_vars = c("edad_jep", "yy_hecho"),
                                                conflict_filter = TRUE,
                                                edad_minors_filter = FALSE,
                                                include_props = TRUE)

tabla_combinada_secuestro <- tabla_combinada_secuestro %>% 
  select(yy_hecho, edad_jep, observed, obs_prop_na, obs_prop, imp_lo, imp_mean, imp_hi,
         imp_lo_p, imp_mean_p, imp_hi_p ) %>%
	merge(donante_edad_jep_secue, by = c("edad_jep", "yy_hecho")) 

tabla_combinada_reclutamiento <- verdata::combine_replicates("reclutamiento",
                                                tabla_documentada_reclutamiento,
                                                replicas_reclutamiento, 
                                                strata_vars = c("edad_jep", "yy_hecho"),
                                                conflict_filter = TRUE,
                                                edad_minors_filter = FALSE,
                                                include_props = TRUE)

tabla_combinada_reclutamiento <- tabla_combinada_reclutamiento %>% 
  select(yy_hecho, edad_jep, observed, obs_prop_na, obs_prop, imp_lo, imp_mean, imp_hi,
         imp_lo_p, imp_mean_p, imp_hi_p ) %>%
	merge(donante_edad_jep_reclu, by = c("edad_jep", "yy_hecho"))  

```

# Desaparición - edad_jep

## Comparación de resultados

Infancia:

```{r}
infancia_proyecto_desap <- tabla_combinada_desaparicion %>%
	  filter(edad_jep == "INFANCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_desap_infancia_year_imp <- infancia_proyecto_desap %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(infancia_proyecto_desap$imp_hi,
																				 na.rm = TRUE), by = 200)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la infancia (de 0 a 14 años)",
         color = "",
    		 title = "Desapariciones Forzadas") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_desap_infancia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_desap_infancia_year_imp.jpg"),
			 plot_desap_infancia_year_imp, width = 7, height = 7)

```

Adolescencia:

```{r}
adolescencia_proyecto_desap <- tabla_combinada_desaparicion %>%
	  filter(edad_jep == "ADOLESCENCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_desap_adolescencia_year_imp <- adolescencia_proyecto_desap %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adolescencia_proyecto_desap$imp_hi,
																				 na.rm = TRUE), by = 100)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adolescencia (de 15 a 19 años)",
         color = "",
    		 title = "Desapariciones Forzadas") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_desap_adolescencia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_desap_adolescencia_year_imp.jpg"),
			 plot_desap_adolescencia_year_imp, width = 7, height = 7)

```


Adultez:

```{r}
adultez_proyecto_desap <- tabla_combinada_desaparicion %>%
	  filter(edad_jep == "ADULTEZ",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_desap_adultez_year_imp <- adultez_proyecto_desap %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adultez_proyecto_desap$imp_hi,
																				 na.rm = TRUE), by = 1000)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adultez (20 años en adelante)",
         color = "",
    		 title = "Desapariciones Forzadas") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_desap_adultez_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_desap_adultez_year_imp.jpg"),
			 plot_desap_adultez_year_imp, width = 7, height = 7)

```

# Homicidio - edad_jep

## Comparación de resultados

Infancia:

```{r}
infancia_proyecto_homi <- tabla_combinada_homicidio %>%
	  filter(edad_jep == "INFANCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_homi_infancia_year_imp <- infancia_proyecto_homi %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(infancia_proyecto_homi$imp_hi,
																				 na.rm = TRUE), by = 300)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la infancia (de 0 a 14 años)",
         color = "",
    		 title = "Homicidios") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_homi_infancia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_homi_infancia_year_imp.jpg"),
			 plot_homi_infancia_year_imp, width = 7, height = 7)

```

Adolescencia:

```{r}
adolescencia_proyecto_homi <- tabla_combinada_homicidio %>%
	  filter(edad_jep == "ADOLESCENCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_homi_adolescencia_year_imp <- adolescencia_proyecto_homi %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adolescencia_proyecto_homi$imp_hi,
																				 na.rm = TRUE), by = 200)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adolescencia (de 15 a 19 años)",
         color = "",
    		 title = "Homicidios") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_homi_adolescencia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_homi_adolescencia_year_imp.jpg"),
			 plot_homi_adolescencia_year_imp, width = 7, height = 7)

```

Adultez:

```{r}
adultez_proyecto_homi <- tabla_combinada_homicidio %>%
	  filter(edad_jep == "ADULTEZ",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_homi_adultez_year_imp <- adultez_proyecto_homi %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adultez_proyecto_homi$imp_hi,
																				 na.rm = TRUE), by = 2000)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adultez (20 años en adelante)",
         color = "",
    		 title = "Homicidios") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_homi_adultez_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_homi_adultez_year_imp.jpg"),
			 plot_homi_adultez_year_imp, width = 7, height = 7)

```

# Secuestro - edad_jep

## Comparación de resultados

Infancia:

```{r}
infancia_proyecto_secue <- tabla_combinada_secuestro %>%
	  filter(edad_jep == "INFANCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_secue_infancia_year_imp <- infancia_proyecto_secue %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(infancia_proyecto_secue$imp_hi,
																				 na.rm = TRUE), by = 100)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la infancia (de 0 a 14 años)",
         color = "",
    		 title = "Secuestros") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_secue_infancia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_secue_infancia_year_imp.jpg"),
			 plot_secue_infancia_year_imp, width = 7, height = 7)

```

Adolescencia:

```{r}
adolescencia_proyecto_secue <- tabla_combinada_secuestro %>%
	  filter(edad_jep == "ADOLESCENCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_secue_adolescencia_year_imp <- adolescencia_proyecto_secue %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adolescencia_proyecto_secue$imp_hi,
																				 na.rm = TRUE), by = 50)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adolescencia (de 15 a 19 años)",
         color = "",
    		 title = "Secuestros") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_secue_adolescencia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_secue_adolescencia_year_imp.jpg"),
			 plot_secue_adolescencia_year_imp, width = 7, height = 7)

```

Adultez:

```{r}
adultez_proyecto_secue <- tabla_combinada_secuestro %>%
	  filter(edad_jep == "ADULTEZ",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_secue_adultez_year_imp <- adultez_proyecto_secue %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adultez_proyecto_secue$imp_hi,
																				 na.rm = TRUE), by = 400)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adultez (20 años en adelante)",
         color = "",
    		 title = "Secuestros") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_secue_adultez_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_secue_adultez_year_imp.jpg"),
			 plot_secue_adultez_year_imp, width = 7, height = 7)

```

# Reclutamiento - edad_jep

## Comparación de resultados

Infancia:

```{r}
infancia_proyecto_reclu <- tabla_combinada_reclutamiento %>%
	  filter(edad_jep == "INFANCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_reclu_infancia_year_imp <- infancia_proyecto_reclu %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(infancia_proyecto_reclu$imp_donante,
																				 na.rm = TRUE), by = 100)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la infancia (de 0 a 14 años)",
         color = "",
    		 title = "Reclutamientos") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_reclu_infancia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_reclu_infancia_year_imp.jpg"),
			 plot_reclu_infancia_year_imp, width = 7, height = 7)

```

Adolescencia:

```{r}
adolescencia_proyecto_reclu <- tabla_combinada_reclutamiento %>%
	  filter(edad_jep == "ADOLESCENCIA",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_reclu_adolescencia_year_imp <- adolescencia_proyecto_reclu %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adolescencia_proyecto_reclu$imp_donante,
																				 na.rm = TRUE), by = 100)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adolescencia (de 15 a 19 años)",
         color = "",
    		 title = "Reclutamientos") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_reclu_adolescencia_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_reclu_adolescencia_year_imp.jpg"),
			 plot_reclu_adolescencia_year_imp, width = 7, height = 7)

```

Adultez:

```{r}
adultez_proyecto_reclu <- tabla_combinada_reclutamiento %>%
	  filter(edad_jep == "ADULTEZ",
	  			 yy_hecho >= 1993) %>%
    mutate(observed = as.numeric(observed)) %>% 
    arrange((yy_hecho))

plot_reclu_adultez_year_imp <- adultez_proyecto_reclu %>%
    mutate(yy_hecho = as.numeric(yy_hecho)) %>% 
	  filter(yy_hecho >= 1998) %>%
    ggplot(aes(x = yy_hecho)) +
    geom_line(aes(y = observed, color = "Observado"),  size = 1) +
    geom_line(aes(y = imp_mean,  color = "Imputado JEP-CEV-HRDAG"), size = 1) +
	  geom_line(aes(y = imp_donante,  color = "Imputado por Donante"), size = 1) +
	  geom_ribbon(aes(ymin = imp_lo,
                    ymax = imp_hi),
	  						fill = "#1F74B1",
                alpha = 0.2) +
    theme_minimal() +
    theme(axis.text.x = element_text(size = 11, angle = 90),
        axis.title.y = element_text(size = 11),
        axis.ticks.x = element_line(size = 0.1)) +
    scale_x_continuous(breaks = seq(1980, 2016, 2)) +
		scale_y_continuous(breaks = seq(0, max(adultez_proyecto_reclu$imp_hi,
																				 na.rm = TRUE), by = 20)) +
    theme(legend.position = "bottom") +
    labs(x = "Año",
         y = "Número de víctimas en la adultez (20 años en adelante)",
         color = "",
    		 title = "Reclutamientos") +
    scale_colour_manual(values = c("Imputado JEP-CEV-HRDAG" = "#1F74B1", 
                               "Observado" = "#434343",
    															 "Imputado por Donante" = "red"))

plot_reclu_adultez_year_imp

ggsave(paste0(output_dir,"/edad_jep/plot_reclu_adultez_year_imp.jpg"),
			 plot_reclu_adultez_year_imp, width = 7, height = 7)

```
